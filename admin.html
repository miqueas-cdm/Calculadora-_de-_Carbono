<script>
    function fetchClientData() {
        // Obtém dados do Local Storage
        const clientData = JSON.parse(localStorage.getItem('clientData')) || [];

        let totalFuelEmissions = 0;
        let totalElectricityEmissions = 0;

        const clientTable = document.getElementById('clientTable');
        clientTable.innerHTML = ''; // Limpa o conteúdo anterior

        clientData.forEach((client, index) => {
            const fuelEmissions = (client.carDistance / 10) * client.fuelFactor;
            const electricityEmissionFactor = 0.085;
            const electricityEmissions = client.electricity * 12 * electricityEmissionFactor;
            const totalEmissions = fuelEmissions + electricityEmissions;

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${client.name}</td>
                <td>${client.carDistance}</td>
                <td>${client.electricity}</td>
                <td>${client.fuelFactor == 2.3 ? 'Gasolina' : client.fuelFactor == 2.6 ? 'Diesel' : 'Etanol'}</td>
                <td>${totalEmissions.toFixed(2)} kg CO₂</td>
            `;
            clientTable.appendChild(row);

            totalFuelEmissions += fuelEmissions;
            totalElectricityEmissions += electricityEmissions;
        });

        generatePieChart(totalFuelEmissions, totalElectricityEmissions);
    }

    function clearData() {
        if (confirm("Tem certeza que deseja limpar todos os dados?")) {
            localStorage.removeItem('clientData');
            fetchClientData();
            alert("Todos os dados foram limpos.");
        }
    }

    window.onload = fetchClientData;
</script>
